import"./modulepreload-polyfill-B5Qt9EMX.js";import{o as h,s as v,a as u,g as y,c as b,f as w}from"./firebase-CXxq4kdy.js";h(u,s=>{s?(document.querySelector("h2").textContent=`Bem-vindo, ${s.displayName||"UsuÃ¡rio"}!`,F(s.uid)):window.location.href="login.html"});async function F(s){try{const n=await p(s,"ganhos"),a=await p(s,"despesas"),r=await p(s,"investimentos"),t=n.reduce((d,i)=>d+i.valor,0),c=a.reduce((d,i)=>d+i.valor,0),l=r.reduce((d,i)=>d+i.valor,0),m=t-c-l;document.getElementById("saldo-atual").textContent=`R$ ${m.toFixed(2)}`,document.getElementById("despesas-mes").textContent=`R$ ${c.toFixed(2)}`,document.getElementById("investimentos").textContent=`R$ ${l.toFixed(2)}`,$(n,a,r),E(r)}catch(n){console.error("Erro ao carregar dados financeiros:",n)}}async function p(s,n){try{const a=await y(b(w,"usuarios",s,n)),r=[];return a.forEach(t=>{r.push({id:t.id,...t.data()})}),r}catch(a){return console.error(`Erro ao recuperar ${n}:`,a),[]}}function $(s,n,a){const r=document.getElementById("grafico-despesas");if(!r)return;const t={},c=new Set;s.forEach(e=>{const g=new Date(e.data),o=`${g.getFullYear()}-${String(g.getMonth()+1).padStart(2,"0")}`;c.add(o),t[o]||(t[o]={ganhos:0,despesas:0,investimentos:0}),t[o].ganhos+=e.valor}),n.forEach(e=>{const g=new Date(e.data),o=`${g.getFullYear()}-${String(g.getMonth()+1).padStart(2,"0")}`;c.add(o),t[o]||(t[o]={ganhos:0,despesas:0,investimentos:0}),t[o].despesas+=e.valor}),a.forEach(e=>{const g=new Date(e.data),o=`${g.getFullYear()}-${String(g.getMonth()+1).padStart(2,"0")}`;c.add(o),t[o]||(t[o]={ganhos:0,despesas:0,investimentos:0}),t[o].investimentos+=e.valor});const l=Array.from(c).sort(),m=l,d=l.map(e=>t[e].despesas),i=l.map(e=>t[e].ganhos-t[e].despesas-t[e].investimentos),f=l.map(e=>t[e].investimentos);new Chart(r.getContext("2d"),{type:"bar",data:{labels:m,datasets:[{label:"Gastos",data:d,backgroundColor:"#FF5722"},{label:"Saldo Final",data:i,backgroundColor:"#4CAF50"},{label:"Investimentos",data:f,backgroundColor:"#FFD700"}]},options:{responsive:!0,aspectRatio:2,plugins:{legend:{display:!0,position:"top"}},scales:{x:{stacked:!1},y:{stacked:!1,beginAtZero:!0}}}})}function E(s){const n=document.getElementById("grafico-investimentos");if(!n)return;const a={},r=new Set;s.forEach(m=>{const d=new Date(m.data),i=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}`;r.add(i),a[i]||(a[i]={investimentos:0}),a[i].investimentos+=m.valor});const t=Array.from(r).sort(),c=t,l=t.map(m=>a[m].investimentos);new Chart(n.getContext("2d"),{type:"line",data:{labels:c,datasets:[{label:"Investimentos",data:l,borderColor:"#FFD700",fill:!1}]},options:{responsive:!0,aspectRatio:2,plugins:{legend:{display:!0,position:"top"}},scales:{x:{type:"category"},y:{beginAtZero:!0}}}})}document.getElementById("btn-sair").addEventListener("click",()=>{v(u).then(()=>{window.location.href="login.html"}).catch(s=>{console.error("Erro ao sair:",s)})});
